#!/usr/bin/env python

import sys
import click
import importlib
from lightflow.models import Dag


@click.group()
def cli():
    pass


@click.command()
@click.argument('dag')
def run(dag):
    #sys.path.append('/home/molla/projects/socro/dags')
    m = importlib.import_module(dag)  # TODO: check that this dag exists!!!!!
    for dag in list(m.__dict__.values()):
        if isinstance(dag, Dag):
            dag.run()  # TODO: allow a master dag or similar concept


@click.command()
def info():
    pass


cli.add_command(run, 'run')
cli.add_command(info, 'info')

if __name__ == '__main__':
    cli()
